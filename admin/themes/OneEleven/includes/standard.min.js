(function(e,t){"use strict";var n=e.OE={};t(document).ready(function(){n.helper.init();n.view.init()});n.helper={init:function(){var e=this;t("a[rel=external]").attr("target","_blank");t("input.defaultfocus:eq(0), input[autofocus]").focus();if(!e._isLocalStorage()){e.loadScript("themes/OneEleven/includes/jquery.cookie.min.js")}},loadScript:function(e,n,r){var i=true,s=null,o=true;if(t.isFunction(n)){s=n;i=r||i}else{i=n||i;s=r||s}t('script[type="text/javascript"]').each(function(){var n=e!==t(this).attr("src");return n});if(o){t.ajax({type:"GET",url:e,async:false,success:s,dataType:"script",cache:i})}else{if(t.isFunction(s)){s.call(this)}}},setStorageValue:function(e,n,r){var i=this,s=(new Date).getTime()+r*24*60*60*1e3,o={};try{if(i._isLocalStorage()===true){localStorage.removeItem(e);if(r!==null){o={value:n,timestamp:s}}else{o={value:n,timestamp:""}}localStorage.setItem(e,JSON.stringify(o))}else{if(r!==null){o={expires:r}}if(t.fn.cookie!=="undefined"){t.cookie(e,n,o)}}}catch(u){console.log("localStorage Error: set("+e+", "+n+")");console.log(u)}},getStorageValue:function(e){var n=this,r="",i;if(n._isLocalStorage()){r=JSON.parse(localStorage.getItem(e));if(r!==null&&r.timestamp<(new Date).getTime()){n.removeStorageValue(e)}else if(r!==null){i=r.value}}else{if(t.fn.cookie!=="undefined"){i=t.cookie(e)}}return i},removeStorageValue:function(e){var n=this;if(n._isLocalStorage()){localStorage.removeItem(e)}else{t.cookie(e,null)}},equalHeight:function(e){var n=0,r;e.each(function(){var e=t(this),r=e.height();if(r>n){n=r}});e.height(n)},_isLocalStorage:function(){return typeof Storage!=="undefined"},_isMobileDevice:function(){var e=/(Android|iPhone|iPad|iPod|Blackberry|Dolphin|IEMobile|WPhone|Windows Mobile|IEMobile9||IEMobile10||IEMobile11|Kindle|Mobile|MMP|MIDP|Pocket|PSP|Symbian|Smartphone|Sreo|Up.Browser|Up.Link|Vodafone|WAP|Opera Mini|Opera Tablet|Mobile|Fennec)/i;if(e.test(navigator.userAgent)&&(document.documentElement.hasOwnProperty("ontouchstart")||window.DocumentTouch&&document instanceof DocumentTouch)){return true}}};n.view={init:function(){var e=this,n=t(".toggle-button"),r=t("#oe_container"),i=t("#oe_pagemenu"),s=t(".toggle-dropzone"),o=t(".pageheader");t("#oe_admin-content").css("min-height",t("#oe_sidebar").height());n.on("click",function(t){t.preventDefault();if(r.hasClass("sidebar-on")){e._closeSidebar(r,i)}else{e._showSidebar(r,i)}});e.toggleDropzone(s,o);e.toggleSubMenu(i,50);e.showNotifications();e.setUIButtons();e.updateDisplay();t(window).resize(function(){t(".dashboard-inner").css("height","auto");e.updateDisplay()})},handleSidebar:function(e,t){var r=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;if(n.helper.getStorageValue("sidebar-pref")==="sidebar-off"&&r>768){t.addClass("sidebar-off").removeClass("sidebar-on");e.addClass("open-sidebar")}else{t.addClass("sidebar-on").removeClass("sidebar-off");e.addClass("close-sidebar")}},stickyMenu:function(e){var n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i=e.offset(),s=i.top,o=i.left,u=t(window).scrollTop();t(window).scroll(function(){if(n<768){e.css({marginTop:"45px",position:"relative"})}else if(n>=768&&r>=e.height()){u=t(window).scrollTop();if(u>=s){e.css({marginTop:"-100px",position:"fixed"})}else if(u<s){e.css({marginTop:"45px",position:"relative"})}}})},toggleDropzone:function(e,r){e.click(function(i){i.preventDefault();t(".drop").toggleClass("hidden");if(t(".drop").hasClass("hidden")){r.addClass("drop-hidden");n.helper.setStorageValue("dropzone-pref","hidden",60)}else{e.removeClass("drop-hidden");n.helper.removeStorageValue("dropzone-pref")}});if(n.helper.getStorageValue("dropzone-pref")==="hidden"){t(".drop").addClass("hidden");r.addClass("drop-hidden")}else{t(".pageheader").addClass("drop-visible")}},toggleSubMenu:function(e,n){e.find("li.current span").addClass("open-sub");e.find("> li > span").click(function(){var r=t(this).next();if(r.is(":visible")===false){e.find("ul").slideUp(n)}r.slideToggle(n)})},showNotifications:function(){t(".pagewarning, .message, .pageerrorcontainer, .pagemcontainer").prepend('<span class="close-warning"></span>');t(".close-warning").click(function(){t(this).parent().hide()});var e=t("body").attr("id")+"_notification";t(".pagewarning .close-warning").click(function(){n.helper.setStorageValue(e,"hidden",60)});if(n.helper.getStorageValue(e)==="hidden"){t(".pagewarning").addClass("hidden")}t(".message:not(.no-slide)").click(function(){t(".message").slideUp()});t(".message:not(.no-slide), .pageerrorcontainer:not(.no-slide), .pagemcontainer:not(.no-slide)").each(function(){var e=t(this);t(e).hide().slideDown(1e3,function(){window.setTimeout(function(){e.slideUp()},1e4)})});t(document).on("cms_ajax_apply",function(e){t("button[name=cancel], button[name=m1_cancel]").fadeOut();t("button[name=cancel], button[name=m1_cancel]").button("option","label",e.close);t("button[name=cancel], button[name=m1_cancel]").fadeIn();var n="";if(e.response==="Success"){n='<aside class="message pagemcontainer" role="status"><span class="close-warning">Close</span><p class="pagemessage">'+e.details+"</p></aside>"}else{n='<aside class="message pageerrorcontainer" role="alert"><span class="close-warning">Close</span><ul class="pageerror">';n+=e.details;n+="</ul></aside>"}console.log(e.response);t("body").append(n).slideDown(1e3,function(){window.setTimeout(function(){t(".message").slideUp()},1e4)});t(".message").click(function(){t(".message").slideUp()})})},setUIButtons:function(){t('input[type="submit"], input[type="button"]').each(function(){var e=t(this),n="ui-icon-circle-check",r=t("<button />");if(!e.hasClass("noautobtn")){if(e.is("[name*=apply]")){n="ui-icon-disk"}else if(e.is("[name*=cancel]")){n="ui-icon-circle-close"}else if(e.is("[name*=resettodefault]")||e.attr("id")==="refresh"){n="ui-icon-refresh"}}t(this.attributes).each(function(e,t){r.attr(t.name,t.value)});r.button({icons:{primary:n},label:e.val()});e.replaceWith(r)});t("a.pageback").addClass("ui-state-default ui-corner-all").prepend('<span class="ui-icon ui-icon-arrowreturnthick-1-w">').hover(function(){t(this).addClass("ui-state-hover")},function(){t(this).removeClass("ui-state-hover")});t(".cmsms-button").each(function(e){var n=t(this).data("uiIcon");t(this).button({icons:{primary:n}})})},updateDisplay:function(){var e=this,r=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,i=t(".toggle-button"),s=t("#oe_container"),o=t("#oe_menu"),u=t(".dashboard-inner");e.handleSidebar(i,s);n.helper.equalHeight(u);if(!n.helper._isMobileDevice()){e.stickyMenu(o)}},_showSidebar:function(e,t){e.addClass("sidebar-on").removeClass("sidebar-off");t.find("li.current ul").show();n.helper.setStorageValue("sidebar-pref","sidebar-on",60)},_closeSidebar:function(e,t){e.removeClass("sidebar-on").addClass("sidebar-off");t.find("li ul").hide();n.helper.setStorageValue("sidebar-pref","sidebar-off",60)}}})(this,jQuery)